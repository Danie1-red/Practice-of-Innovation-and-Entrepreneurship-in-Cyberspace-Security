# Google Password Checkup Demo

> 基于 DDH-based PI-Sum 协议的隐私保护密码安全检查演示

本项目实现了论文 "On Deploying Secure Computing: Private Intersection-Sum-with-Cardinality" Section 3.1 中描述的 DDH-based PI-Sum 协议，并基于 **Google Password Checkup** 真实应用场景创建了完整的演示系统。

## 🚀 快速开始

```bash
# 克隆或进入项目目录
cd /path/to/project6

# 安装依赖（只需要一个核心依赖）
pip install cryptography

# 运行演示
python quick_demo.py
```

## 📋 项目概述

### 实际应用背景

此协议是 **Google Password Checkup** 功能的核心技术，已在 Chrome 浏览器中大规模部署：

- 🎯 **真实部署**：Chrome 浏览器内置功能
- 📊 **用户规模**：服务全球数十亿用户
- 🔒 **隐私保护**：Google 无法获知用户密码
- 📈 **性能表现**：单次查询 < 1 秒响应
- 🛡️ **安全保障**：基于密码学难题的形式化安全

### 技术特性

- **DDH 困难假设**：使用 1024 位安全素数群
- **Paillier 同态加密**：支持加密状态下的求和运算
- **双掩码隐私保护**：确保标识符查询隐私
- **随机洗牌机制**：防止位置关联攻击
- **Miller-Rabin 素性测试**：工业级密码学参数

## 📁 项目结构

```
project6/                                    [精简版，总大小约 56KB]
├── 📖 README.md                            # 项目文档（本文件）
├── 📦 requirements.txt                     # 依赖配置
│
├── 🔐 核心协议实现/
│   ├── secure_pi_sum_protocol.py          ⭐ 生产级安全实现
│   └── test_pi_sum_protocol.py            🧪 完整测试套件
│
└── 🎮 演示程序/
    ├── password_checkup_demo.py           ✅ 密码安全检查演示
    └── quick_demo.py                      🚀 演示启动器
```

### 核心文件说明

| 文件                        | 描述                               | 推荐度 |
| --------------------------- | ---------------------------------- | ------ |
| `secure_pi_sum_protocol.py` | 生产级协议实现，包含完整的安全机制 | ⭐⭐⭐ |
| `password_checkup_demo.py`  | Google Password Checkup 命令行演示 | ⭐⭐⭐ |
| `test_pi_sum_protocol.py`   | 完整测试套件，验证协议正确性       | ⭐⭐   |
| `quick_demo.py`             | 演示启动器，提供统一入口           | ⭐⭐   |

## 🔬 演示效果

### 弱密码检测（危险）

- `123456` - 检测到 **23,597,311** 次泄露 ⚠️
- `password` - 检测到 **20,958,297** 次泄露 ⚠️
- `admin` - 检测到 **3,746,351** 次泄露 ⚠️

### 强密码验证（安全）

- `MySecure2024!` - 未发现泄露记录 ✅
- 复杂密码组合 - 通过安全检查 ✅

## 📊 性能指标

- **单次查询耗时**：~800ms
- **内存使用**：适中（DDH 群运算）
- **通信轮次**：严格 3 轮交互
- **数据传输**：经过加密和掩码处理

## 🧪 测试验证

协议通过了完整的测试套件验证：

- ✅ **协议正确性**：所有测试场景 100% 通过
- ✅ **空交集处理**：正确返回 0 大小和 0 和
- ✅ **完全交集计算**：准确计算交集大小和数值总和
- ✅ **部分交集场景**：正确识别部分重叠数据
- ✅ **大规模数据**：支持 1000+ 元素高效处理
- ✅ **边界条件**：单元素、零值等特殊情况

## 💡 使用方法

### 方法 1：使用演示启动器（推荐）

```bash
python quick_demo.py
```

### 方法 2：直接运行密码检查

```bash
python password_checkup_demo.py
```

### 方法 3：运行测试套件

```bash
python test_pi_sum_protocol.py
```

## 🖥️ 运行结果展示

### 快速演示启动器效果 (`python quick_demo.py`)

```
🎉 欢迎使用 Google Password Checkup 演示系统!
   基于 DDH-based PI-Sum 协议的隐私保护密码检查

============================================================
🔒 Google Password Checkup - 快速演示
   基于 DDH-based PI-Sum 协议
============================================================

可用演示:
1. 🎯 密码安全检查演示 (命令行版)
2. 🧪 协议测试套件
0. 退出

请选择 (0-2): 1
```

### 密码安全检查演示效果

#### 弱密码检测结果

```
🔍 测试密码: 常见弱密码 (123456)
🔐 正在安全检查您的密码...
📡 与 Google 服务器建立安全连接...

P2 Round 1: 发送 20 个掩码标识符和加密值
P1 Round 2: 处理来自 P2 的 20 个数据项
P1: 完成双掩码和洗牌，处理了 20 个项目
P1: 生成并洗牌了 1 个自己的掩码标识符
P2 Round 3: 开始计算交集
P2: 完成对 P1 标识符的双掩码处理，共 1 个
P2: P2 双掩码数据共 20 个
P2: 发现交集大小为 1
P2: 完成同态求和计算

⚠️  密码存在风险：已在数据泄露事件中发现
   泄露次数: 23,597,311 次
   建议: 立即更改此密码
   检查耗时: 690.7 毫秒
   隐私保护: ✅ 已保护
```

#### 强密码验证结果

```
🔍 测试密码: 强密码 (MySecure2024!)
🔐 正在安全检查您的密码...
📡 与 Google 服务器建立安全连接...

P2 Round 1: 发送 20 个掩码标识符和加密值
P1 Round 2: 处理来自 P2 的 20 个数据项
P1: 完成双掩码和洗牌，处理了 20 个项目
P1: 生成并洗牌了 1 个自己的掩码标识符
P2 Round 3: 开始计算交集
P2: 完成对 P1 标识符的双掩码处理，共 1 个
P2: P2 双掩码数据共 20 个
P2: 发现交集大小为 0
P2: 完成同态求和计算

✅ 密码安全：未在已知泄露数据库中发现
   检查耗时: 832.87 毫秒
   隐私保护: ✅ 已保护
```

### 协议测试套件结果 (`python test_pi_sum_protocol.py`)

```
==================================================
DDH-based PI-Sum Protocol 测试套件
==================================================

测试1: 空交集场景
P2 Round 1: 发送 3 个掩码标识符和加密值
P1 Round 2: 处理来自 P2 的 3 个数据项
P1: 完成双掩码和洗牌，处理了 3 个项目
P1: 生成并洗牌了 3 个自己的掩码标识符
P2 Round 3: 开始计算交集
P2: 完成对 P1 标识符的双掩码处理，共 3 个
P2: P2 双掩码数据共 3 个
P2: 发现交集大小为 0
P2: 完成同态求和计算
P1 最终结果:
  交集大小: 0
  交集值总和: 0
✓ 空交集测试通过

测试2: 完全交集场景
P1 最终结果:
  交集大小: 3
  交集值总和: 600
✓ 完全交集测试通过

测试3: 部分交集场景
P1 最终结果:
  交集大小: 2
  交集值总和: 400
✓ 部分交集测试通过 (交集: {'user2', 'user4'}, 大小: 2, 和: 400)

测试4: 大规模数据场景
  数据规模: P1=1000, P2=800
  期望交集大小: 200
  期望交集和: 53382
P1 最终结果:
  交集大小: 200
  交集值总和: 53382
✓ 大规模数据测试通过

测试5: 包含零值场景
P1 最终结果:
  交集大小: 3
  交集值总和: 100
✓ 零值测试通过 (交集和: 100)

测试6: 单元素场景
P1 最终结果:
  交集大小: 1
  交集值总和: 123
✓ 单元素测试通过

==================================================
✅ 所有测试通过！协议实现正确且健壮
==================================================

协议验证报告:
✓ 正确性: 所有场景下计算结果准确
✓ 完整性: 支持空集、全集、部分交集等各种情况
✓ 安全性: 基于DDH假设和Paillier同态加密
✓ 可扩展性: 支持大规模数据集处理
✓ 健壮性: 正确处理边界情况和特殊值
```

### 实际性能表现

- **单次密码检查**：700-1100ms（包含完整的 3 轮协议交互）
- **协议轮次**：严格执行 3 轮 DDH-based PI-Sum 协议
- **隐私保护**：✅ 双方隐私完全保护
- **准确性**：100%正确识别密码泄露状态
- **大规模支持**：成功处理 1000+元素集合交集计算

## 🔐 协议详解

### 问题定义

**Private Intersection-Sum with Cardinality (PI-Sum-C)**：

- 两方 P₁ 和 P₂ 分别持有用户标识符集合
- P₂ 额外拥有每个标识符的整数值（如密码泄露次数）
- 目标：安全计算交集大小和交集标识符对应值的总和
- 隐私要求：除结果外不泄露任何其他信息

### 协议流程

1. **Round 1**: P₂ → P₁

   - P₂ 发送单掩码标识符和同态加密值
   - 使用 DDH 掩码保护标识符隐私

2. **Round 2**: P₁ → P₂

   - P₁ 对接收数据应用第二次掩码并洗牌
   - P₁ 发送自己的单掩码标识符

3. **Round 3**: P₂ 计算结果
   - P₂ 对 P₁ 标识符应用掩码得到双掩码
   - 计算交集并进行同态求和
   - 返回交集大小和加密的值总和

### 安全性保证

- **DDH 假设**：基于判定性 Diffie-Hellman 困难假设
- **半诚实安全**：参与者遵守协议但可能窃听
- **隐私保护**：双方都无法获知对方的私有信息
- **形式化证明**：具有严格的密码学安全证明

## 🎓 学习价值

- **理论与实践结合**：从学术论文到工业应用的完整实现
- **密码学应用**：深入理解 DDH 假设和同态加密的实际运用
- **隐私计算**：体验隐私保护计算的实际部署场景
- **系统设计**：了解 Google 级别系统的架构设计思路
- **测试方法**：学习密码学协议的测试和验证方法

## 🚀 技术亮点

1. **实际应用驱动**：基于 Google 真实部署场景
2. **密码学严谨**：严格遵循学术论文协议
3. **测试完备**：覆盖各种边界和异常情况
4. **结构精简**：核心功能完整，无冗余代码
5. **性能优化**：适合大规模数据处理

## 📝 依赖说明

项目经过精简，只需要一个核心依赖：

```txt
# 核心依赖（必需）
cryptography>=3.4.8      # 密码学库，用于 Paillier 加密和哈希函数
```

## 🎉 项目成果

- ✅ **完整实现**了学术论文中的核心协议
- ✅ **创建了丰富**的演示程序展示协议功能
- ✅ **建立了完整**的测试验证体系
- ✅ **连接了理论**研究与实际工业应用
- ✅ **提供了精简**且重点突出的项目结构

---

**🎊 项目圆满完成！欢迎体验基于 DDH-based PI-Sum 协议的隐私保护密码检查！**
